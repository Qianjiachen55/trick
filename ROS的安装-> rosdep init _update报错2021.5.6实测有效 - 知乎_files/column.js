(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1448:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return R}));var n=a(29),c=a.n(n),o=a(1),i=a.n(o),s=a(6),l=a.n(s),d=a(528),r=a(577),u=a.n(r);function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.trimZero,n=void 0!==a&&a,c=String(e).padStart(2,"0").slice(-2);return n&&"00"===c?"".concat(Math.floor(e/100)):"".concat(Math.floor(e/100),".").concat(c)}var b={"淘宝":"taobao","天猫":"tmall","京东":"jingdong","京东自营":"jingdongSale","知乎":"zhihu","美团酒旅":"meituanhotel","苏宁":"suning","有赞":"youzan"},v=a(2),O=a.n(v),j=a(8),f=a(3),p={1:"正版保障 · 七天无理由退货",2:"正版保障 · 京东快递"},h=function(e){var t=e.className,a=e.style,n=e.id,c=e.skuId,i=e.imgUrl,s=e.title,d=e.price,r=void 0===d?0:d,u=e.source,v=e.productType,O=e.showBottomLine,h=void 0===O||O,g=e.abInfo,C=e.zaData,k=void 0===C?{}:C,N=e.onClick,y="¥ ".concat(m(parseInt(r))),w=u,I=(g||{}).params;"zhihu"===b[u]&&7===v&&(w="知乎 · 纸书");var S=(null==I?void 0:I.length)>0&&"0"!==I[0].value&&"zhihu"===b[u]&&7===v;Object(o.useEffect)((function(){(null==k?void 0:k.showId)&&j.a.trackCardShow(null,{id:null==k?void 0:k.showId,path:[{module_name:"".concat(n,"_").concat(c,"_").concat(b[u])}]})}),[]);return Object(f.d)("div",{className:l()("GoodsItemCard",t),style:a,onClick:function(){(null==k?void 0:k.clickId)&&j.a.trackEvent(null,{id:null==k?void 0:k.clickId,action:"OpenUrl",path:[{module_name:"".concat(n,"_").concat(c,"_").concat(b[u])}]}),"function"==typeof N&&N()}},Object(f.d)("div",{className:"GoodsItemCard-left"},Object(f.d)("div",{className:"GoodsItemCard-imgLayer"}),Object(f.d)("img",{className:"GoodsItemCard-imgUrl",src:i,alt:"",onError:function(){}})),Object(f.d)("div",{className:"GoodsItemCard-right"},Object(f.d)("div",{className:"GoodsItemCard-title"},s),Object(f.d)("div",{className:"GoodsItemCard-footer"},Object(f.d)("span",{className:"GoodsItemCard-price"},y),Object(f.d)("span",{className:"GoodsItemCard-footerText"},w)),S&&Object(f.d)("span",{className:"GoodsItemCard-footerIcon"},p[I[0].value])),Object(f.d)("div",{className:"GoodsItemCard-bottomLine",style:{display:h?"block":"none"}}))};h.prototype={className:O.a.string,style:O.a.object,imgUrl:O.a.string.isRequired,title:O.a.string.isRequired,price:O.a.number,source:O.a.string.isRequired,productType:O.a.number,showBottomLine:O.a.bool,onClick:O.a.func};var g=h,C=a(1156),k=function(e){var t=e.className,a=e.style,n=e.id,c=e.skuId,s=e.imgUrl,d=e.title,r=e.price,u=void 0===r?0:r,v=e.source,O=e.showBottomLine,p=void 0!==O&&O,h=e.zaData,g=void 0===h?{}:h,k=e.onClick,N=e.tags,y="¥ ".concat(m(parseInt(u)));Object(o.useEffect)((function(){(null==g?void 0:g.showId)&&j.a.trackCardShow(null,{id:null==g?void 0:g.showId,path:[{module_name:"".concat(n,"_").concat(c,"_").concat(b[v])}]})}),[]);return Object(f.d)("div",{className:l()("GoodsItemNewCard",t),style:a,onClick:function(){(null==g?void 0:g.clickId)&&j.a.trackEvent(null,{id:null==g?void 0:g.clickId,action:"OpenUrl",path:[{module_name:"".concat(n,"_").concat(c,"_").concat(b[v])}]}),"function"==typeof k&&k()}},Object(f.d)("div",{className:"GoodsItemNewCard-left"},Object(f.d)("div",{className:"GoodsItemNewCard-imgLayer"}),Object(f.d)("img",{className:"GoodsItemNewCard-imgUrl",src:s,alt:"",onError:function(){}})),Object(f.d)("div",{className:"GoodsItemNewCard-right"},Object(f.d)("div",{className:"GoodsItemNewCard-title"},d),Object(f.d)("div",{className:"GoodsItemNewCard-footer"},Object(f.d)("span",{className:"GoodsItemNewCard-price"},y),(null==N?void 0:N.length)&&N.length>0&&Object(f.d)(i.a.Fragment,null,N.map((function(e,t){var a=e.value;return Object(f.d)("span",{key:"".concat(a,"#").concat(t),className:"GoodsItemNewCard-tag"},a)}))),Object(f.d)("div",{className:"GoodsItemNewCard-sourceIcon"},v,Object(f.d)(C.a,{size:20,center:!0})))),Object(f.d)("div",{className:"GoodsItemNewCard-bottomLine",style:{display:p?"block":"none"}}))};k.prototype={className:O.a.string,style:O.a.object,imgUrl:O.a.string.isRequired,title:O.a.string.isRequired,price:O.a.number,source:O.a.string.isRequired,productType:O.a.number,showBottomLine:O.a.bool,onClick:O.a.func,tags:O.a.array};var N=k,y=a(709),w=a(42),I=a.n(w),S=function(){return Object(f.d)(i.a.Fragment,null)},G={SkeletonH01:function(e){var t=e.lineClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t}))},SkeletonP01:function(e){var t=e.lineClass,a=e.blockClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:a}),Object(f.d)("div",null,Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t})))},SkeletonT01:function(e){var t=e.lineClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t}))},SkeletonT02:function(e){var t=e.lineClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t}))},SkeletonC01:function(e){var t=e.lineClass,a=e.blockClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:a}),Object(f.d)("div",null,Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t})))},SkeletonC02:function(e){var t=e.lineClass,a=e.blockClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",null,Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t})),Object(f.d)("div",{className:a}))},SkeletonC03:function(e){var t=e.lineClass,a=e.blockClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:a}),Object(f.d)("div",{style:{width:"100%"}},Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t})))},SkeletonC04:function(e){var t=e.lineClass,a=e.blockClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:"".concat(a,"-1")}),Object(f.d)("div",{className:a}),Object(f.d)("div",{style:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"}},Object(f.d)("div",{className:t}),Object(f.d)("div",{className:t})))},SkeletonI01:function(e){var t=e.blockClass;return Object(f.d)(i.a.Fragment,null,Object(f.d)("div",{className:t}))},SkeletonSpacing:S,SkeletonFill:S},_=i.a.memo((function(e){var t,a=e.variant,n=void 0===a?"H01":a,c=e.height,o=e.width,i=void 0===o?"auto":o,s=e.animation,d=void 0===s?"ease-in":s,r="skeleton__line--".concat(n.toLowerCase()),u="skeleton--".concat(n.toLowerCase()),m=l()(I()({skeleton__block:!0},"skeleton__block--".concat(n.toLowerCase()),!0)),b=l()(I()({skeleton__line:!0},r,!0)),v=l()((t={skeleton:!0},I()(t,u,!0),I()(t,"skeleton--ease-in","ease-in"===d),t)),O={width:i};c&&["Spacing","Fill"].includes(n)&&(O.height="number"==typeof c?"".concat(c,"px"):c);var j=G["Skeleton".concat(n)];return Object(f.d)("section",{className:v,style:O},Object(f.d)(j,{variant:n,lineClass:b,blockClass:m}))}));_.propTypes={variant:O.a.string,height:O.a.oneOfType([O.a.string,O.a.number]),width:O.a.oneOfType([O.a.string,O.a.number]),animation:O.a.oneOfType([O.a.bool,O.a.string])};var T=_;var L=i.a.memo((function(e){var t=e.content,a=function(e){return("string"==typeof e?e.split(","):e).map((function(e){var t=e.split("-"),a=c()(t,2),n=a[0],o=a[1];return["Spacing","Fill"].includes(n)?{type:n,height:+o}:{type:n,count:+o||1}}))}(void 0===t?"T01":t);return Object(f.d)(i.a.Fragment,null,a.map((function(e,t){var a=e.type,n=e.count,c=e.height;return n?Array.from({length:n}).map((function(e,n){return Object(f.d)(T,{variant:a,key:"".concat(t,"-").concat(n)})})):Object(f.d)(T,{variant:a,height:c,key:"".concat(t,"-").concat(c)})})))}));L.prototype={content:Object(v.oneOfType)([Object(v.arrayOf)(v.string),v.string])};var z=L,F=a(32),U={"京东":"jingdong","淘宝":"taobao","拼多多":"pinduoduo","苏宁":"suning","美团酒旅":"meituanhotel","知乎":"zhihu","有赞":"youzan"},E=function(e){var t=e.className,a=e.style,n=e.showModal,s=void 0===n||n,r=e.withModal,m=void 0===r||r,b=e.modalTitle,v=void 0===b?"该商品的所有购买渠道":b,O=e.id,p=e.url,h=void 0===p?"":p,C=e.fetcherOptions,k=void 0===C?{}:C,w=e.scenes,I=void 0===w?0:w,S=e.fetcher,G=void 0===S?d.a:S,_=e.onClose,T=e.onSelectCard;Object(F.g)();var L=Object(o.useState)(0),E=c()(L,2),R=E[0],x=E[1],B=Object(o.useState)(!1),q=c()(B,2),A=q[0],D=q[1],M=Object(o.useState)([]),H=c()(M,2),J=H[0],P=H[1],Z=Object(o.useState)(!1),K=c()(Z,2),Q=K[0],V=K[1],W=Object(o.useState)(null),X=c()(W,2),Y=X[0],$=X[1],ee=Object(o.useState)(null),te=c()(ee,2),ae=te[0],ne=te[1],ce=(J||[]).some((function(e){return 8===e.product_type}))&&"2"===(null==ae?void 0:ae.value);Object(o.useEffect)((function(){j.a.trackCardShow(null,{id:10331,path:[{module_name:O}]}),window.abInfo?$({params:[window.abInfo]}):Object(d.a)("/consume/bff/ab?name=book_kpwz").then((function(e){var t=e.data;t&&($({params:[t]}),window.abInfo=t)})).catch((function(){})),window.cardAbInfo?ne(window.cardAbInfo):Object(d.a)("/consume/bff/ab?name=kpl_card").then((function(e){var t=e.data;t&&(ne(t),window.cardAbInfo=t)})).catch((function(){}))}),[]),Object(o.useEffect)((function(){D(!0);var e=h||"/api/v4/mcn/linkcard/".concat(O,"?scenes=").concat(I);G(e,k).then((function(e){var t=e.data,a=[];if(!u()(t)&&(a.push(Object.assign({},t,{children:null})),"[object Array]"===Object.prototype.toString.call(t.children)&&t.children.length&&(a=a.concat(t.children)),a.some((function(e){return 8===e.product_type})))){var n=[];a.forEach((function(e){"知乎"===e.source?n.unshift(e):n.push(e)})),a=n}P(a)})).catch((function(){V(!0)})).finally((function(){setTimeout((function(){D(!1)}),500)}))}),[O,R]);var oe=function(e){T&&T(e)},ie=Object(f.d)("div",{className:"GoodsCardList-container"},A?Object(f.d)(i.a.Fragment,null,Object(f.d)(z,{content:"C03,Spacing-26,C03",height:72})):Q?Object(f.d)("div",{className:"GoodsCardList-error"},Object(f.d)("div",{className:"GoodsCardList-errorDesc"},"Oops~ 出错了"),Object(f.d)("div",{className:"GoodsCardList-errorBtn",onClick:function(){x(R+1)}},"刷新重试")):J.length?J.map((function(e){var t=e.id,a=e.skuid,n=e.title,c=e.url,o=e.img_url,i=e.price,s=e.source,l=e.product_type,d=e.tags;return Object(f.d)(F.b,{key:"".concat(s,"-").concat(t,"-").concat(a),block:"goodsRecommend_polymericCardPopup_goodsCard",content:{type:"GoodsRecommend",id:"".concat(t,"-").concat(a,"-").concat(U[s])},extra:{link:{url:c}}},Object(f.d)(F.e,{shouldTrackShow:!0,shouldTrackClick:!0,className:"GoodsCardList-listItem",zaType:"Card",zaText:n,zaAction:"OpenUrl",zaEventType:"Click",extra:{link:{url:c}}},ce?Object(f.d)(N,{id:t,skuId:a,title:n,imgUrl:o,price:i,source:s,productType:l,showBottomLine:!1,zaData:{showId:10371,clickId:10372},onClick:function(){return oe(e)},tags:d}):Object(f.d)(g,{id:t,skuId:a,title:n,imgUrl:o,price:i,source:s,productType:l,showBottomLine:!1,abInfo:Y,zaData:{showId:10371,clickId:10372},onClick:function(){return oe(e)}})))})):null);return m?Object(f.d)(y.a,{className:l()("GoodsCardList",t),style:a,size:"large",title:v,onClose:_},s&&ie):ie};E.prototype={className:O.a.string,style:O.a.object,showModal:O.a.bool,withModal:O.a.bool,modalTitle:O.a.string,id:O.a.string,url:O.a.string,fetcherOptions:O.a.object,scenes:O.a.number,fetcher:O.a.func,onClose:O.a.func,onSelectCard:O.a.func};var R=E}}]);
//# sourceMappingURL=column.GoodsRecommendGoodsCardList.65ab22c79d573ff60644.js.map